(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{457:function(t,a,s){t.exports=s.p+"assets/img/spuManagement-updateSpu.51c39008.png"},518:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"静态组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态组件"}},[t._v("#")]),t._v(" 静态组件")]),t._v(" "),a("img",{attrs:{src:s(457)}}),t._v(" "),a("h2",{attrs:{id:"组件介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件介绍"}},[t._v("#")]),t._v(" 组件介绍")]),t._v(" "),a("p",[t._v("用户在Spu组件中，点击“添加/修改spu属性”按钮，页面主区域由SPU列表展示区切换为SPU编辑区。之后在本组件内实现对spu类的新增、修改操作。")]),t._v(" "),a("h2",{attrs:{id:"进入离开组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进入离开组件"}},[t._v("#")]),t._v(" 进入离开组件")]),t._v(" "),a("p",[t._v("作为Spu组件的子组件，由用户在Spu组件，点击“添加SPU”按钮，或者对某个SPU类点击“修改SPU”按钮，进入本组件。")]),t._v(" "),a("p",[t._v("父Spu组件为本组件绑定了一个自定义事件changeScene，以确定本组件是进行添加or修改spu。")]),t._v(" "),a("h2",{attrs:{id:"数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据"}},[t._v("#")]),t._v(" 数据")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("数据类型")]),t._v(" "),a("th",[t._v("所属")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("数据介绍")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("spu")]),t._v(" "),a("td",[t._v("Object")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("与添加修改spu页面里的表单绑定的数据")])]),t._v(" "),a("tr",[a("td",[t._v("tradeMarkList")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("平台内所有的品牌数据；spu的品牌属性从中选择")])]),t._v(" "),a("tr",[a("td",[t._v("saleAttrList")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("平台内所有的商品属性数据；spu的销售属性从中选择")])]),t._v(" "),a("tr",[a("td",[t._v("spuImageList")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("与表单-spu图片绑定的数据")])]),t._v(" "),a("tr",[a("td",[t._v("dialogVisible")]),t._v(" "),a("td",[t._v("Boolean")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("图片上传-展示已上传图片的大图功能里，待展示大图的显示与否")])]),t._v(" "),a("tr",[a("td",[t._v("dialogImageUrl")]),t._v(" "),a("td",[t._v("string")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("图片上传-展示已上传图片的大图功能里，待展示大图的地址")])]),t._v(" "),a("tr",[a("td",[t._v("selectingAttr")]),t._v(" "),a("td",[t._v("string")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("销售属性下拉选择框里，选中的销售属性id+销售属性名")])]),t._v(" "),a("tr",[a("td",[t._v("unSelectedSaleAttr")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("computed")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("平台内，还未被某spu添加属性值的商品属性数据")])])])]),t._v(" "),a("h2",{attrs:{id:"api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),a("p",[t._v("1、新增/修改spu属性及属性值")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('1、新增\n路径：/admin/product/saveSpuInfo\t请求方式：post\t参数：spuInfo\n2、修改\n路径：/admin/product/updateSpuInfo\t\t请求方式：post\t参数：spuInfo\n两个API的区别：新增品牌传给服务器的参数没有id，所以将两个请求合一，通过参数有无id进行区分。\n\nexport const reqAddOrUpdateSpu = (spuInfo) => {\n  if (spuInfo.id) {\n    return request({ url: `/admin/product/updateSpuInfo`, method: "post", data: spuInfo });\n  } \n  else {\n    return request({ url: `/admin/product/saveSpuInfo`, method: "post", data: spuInfo });\n  }\n};\n\n参数spuInfo：\n{\n    category3Id: 0,\t\t// spu所属的三级商品分类的id\n    spuId:\'\',\t\t\t// spu的id\n    spuName: "",   \t\t// spu名称\n    tmId: \'\',   \t\t// spu品牌属性的id\n    description: "",    // spu描述\n    spuImageList: [\t\t// spu图片数组\t\n        {\n            id: 0,\t\t\t// 图片id\n            imgName: "",\t// 图片名称\n            imgurl: "",\t\t// 图片地址\n            spuld: 0\t\t// 图片所属的spu的id\n        }\n        ...\n    ],\n    spuSaleAttrList: [\t\t// spu属性及属性值列表\n        {\n            id: 0,\t\t\t\t\t\t// 属性id\n            saleAttrName: "",\t\t\t// 属性名\n            spuld: 0,\t\t\t\t\t// 图片所属的spu的id\n            spuSaleAttrValueList: [\t\t// 属性下的属性值列表\n                {\n                    id: 0,\t\t\t\t\t// 属性值id\n                    ischecked: "",\t\t\t// 是否被选中编辑\n                    saleAttrValueName: "",\t// 属性值\n                    inputVisible: false,\t// 展示输入框or添加按钮\n                    inputValue: ""\t\t\t// 待输入的属性值文本\n                }\n                ...\n            ]\n        }\n        ...\n    ]\n}\n')])])]),a("p",[t._v("2、获取spu属性")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('路径：/admin/product/getSpuById/{spuId}\t请求方式：get  \t参数：spuId\nexport const reqGetSpuById = (spuId) =>\n  request({ url: `/admin/product/getSpuById/${spuId}`, method: "get" });\n')])])]),a("p",[t._v("3、获取平台所有的品牌数据")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('// 路径：/admin/product/baseTrademark/getTrademarkList\t\t请求方式：get\t\t参数：无\nexport const reqTrademarkList = () =>\n  request({ url: `/admin/product/baseTrademark/getTrademarkList`, method: "get" });\n')])])]),a("p",[t._v("4、获取spu图片")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('// 路径：/admin/product/spuImageList/{spuId}\t请求方式：get\t参数：spuId\nexport const reqSpuImageList = (spuId) =>\n  request({ url: `/admin/product/spuImageList/${spuId}`, method: "get" });\n')])])]),a("p",[t._v("5、获取平台所有的销售属性")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('// 路径：/admin/product/baseSaleAttrList\t请求方式：get\t\t参数：无\nexport const reqBaseSaleAttrList = () =>\n  request({ url: `/admin/product/baseSaleAttrList`, method: "get" });\n')])])]),a("h2",{attrs:{id:"methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#methods"}},[t._v("#")]),t._v(" methods")]),t._v(" "),a("p",[t._v("1、initAddSpuData (category3Id)\t 新增spu时的页面数据初始化")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：category3Id 当前spu所属的三级商品分类的id\n\n2、函数内容：\n2.1、当在父组件Spu中，点击“添加spu属性”按钮时，调用本组件的initAddSpuData函数；\n2.2、调用API-获取平台品牌数据，等待服务器返回结果；如果返回结果成功，将返回的数据保存到data:tradeMarkList中；\n2.3、调用API-获取平台销售属性数据，等待服务器返回结果；如果返回结果成功，将返回的数据保存到data:saleAttrList中；\n")])])]),a("p",[t._v("2、initSpuData (row)\t修改spu时的页面数据初始化")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：row 待修改的spu相关数据\n\n2、函数内容：\n2.1、当在父组件Spu中，点击“修改spu属性”按钮时，调用本组件的initSpuData函数；\n2.2、获取到待修改的spu的id，调用API-获取spu属性，等待服务器返回结果；如果返回结果成功，将返回的数据保存到data:spu中；\n2.3、调用API-获取平台品牌数据，等待服务器返回结果；如果返回结果成功，将返回的数据保存到data:tradeMarkList中；\n2.4、调用API-获取平台销售属性数据，等待服务器返回结果；如果返回结果成功，将返回的数据保存到data:saleAttrList中；\n2.5、调用API-获取spu图片，等待服务器返回结果；如果返回结果成功，对返回的数据进行处理（加上上传图片需要的name等属性）保存到data:spuImageList中；\n")])])]),a("p",[t._v("3、addSaleAttr()\t给spu添加销售属性")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：无\n\n2、函数内容：\n2.1、获取到用户通过下拉框选择的要添加的spu销售属性，对数据进行处理；\n2.2、将处理过的数据添加进data:spu.spuSaleAttrList中，并将data:selectingAttr置空。\n")])])]),a("p",[t._v("4、addsaleAttrValue (row)\t给spu的销售属性添加属性值")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：row 待修改的spu销售属性的相关数据\n\n2、函数内容：\n2.1、将属性值显示切换为属性值编辑；\n2.2、给data:spu-spuSaleAttrList加上inputVisible，inputValue,两个属性字，用来控制属性值的编辑。\n2.3、让属性值编辑的input，获得焦点。\n")])])]),a("p",[t._v("5、handleInputConfirm (row)\tspu销售属性值添加完毕时的调用函数")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：row 待修改的spu销售属性的相关数据\n\n2、函数内容：\n2.1、获取到用户新输入的销售属性值，对其进行检验判断；\n2.2、如果为空，则弹出消息框提示，并将属性值编辑切换为属性值显示；\n2.3、如果与当前属性已有的属性值重复，则弹出消息框提示，并将属性值编辑切换为属性值显示；\n2.4、如果检验通过，则将属性值添加进data:spu.spuSaleAttrList.newspuSaleAttrValue中。\n")])])]),a("p",[t._v("6、addOrUpdateSpu ()\t保存spu属性的操作")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：无\n\n2、函数内容：\n2.1、对data:spuImageList进行处理，并保存至data:spu.spuImageList中（之前对spu图片的数据是保存到data:spuImageList中，现在要保存到服务器，所以需要复制到data:spu中）；\n2.2、调用API-新增/修改spu属性及属性值，等待服务器返回结果；如果返回结果成功，则弹出消息框提示，并触发父组件绑定的自定义事件changeScene，向其传递消息；\n2.3、清理本组件data数据，全部置为空。\n")])])]),a("p",[t._v("7、cancelAddOrUpdate ()\t取消spu属性的操作")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：无\n\n2、函数内容：\n2.1、触发父组件绑定的自定义事件changeScene，向其传递消息；\n2.2、清理本组件data数据，全部置为空。\n")])])]),a("p",[t._v("8、handlerSuccess ()\t上传图片墙的上传图片成功的回调函数")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：response：上传成功后服务器返回的信息，包括code，data(图片在服务器的路径)，message等    file：服务器返回的当前正操作的文件的相关数据    filelist：服务器返回的上传成功后，所有已上传的文件的相关数据\n\n2、函数内容：\n2.1、获取到服务器返回的当前spu图片，所有已上传的图片数据，将其保存到data:spuImageList。\n")])])]),a("p",[t._v("9、handleRemove()\t上传图片墙的删除某张图片的回调函数")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("内容与8：handlerSuccess 一致。\n")])])]),a("p",[t._v("10、handlePictureCardPreview()\t上传图片墙的放大展示某张图片的回调函数")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、参数：file：当前正操作的文件的相关数据  \n\n2、函数内容：\n2.1、将图片地址赋值给data:dialogImageUrl，将data:dialogVisible置为true，以进行待展示大图的显示。\n")])])]),a("h2",{attrs:{id:"功能点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能点"}},[t._v("#")]),t._v(" 功能点")]),t._v(" "),a("p",[t._v("1、页面数据初始化")]),t._v(" "),a("p",[t._v("父组件Spu里点击“添加/修改spu属性”按钮，调用添加/修改spu时的页面数据初始化，调用相应的API，向服务器发送请求；服务器返回成功则将返回的数据保存到组件data中，完成页面数据初始化；")]),t._v(" "),a("p",[t._v("2、spu属性、属性值的添加/修改/删除")]),t._v(" "),a("p",[t._v("用户在表单内的每步操作对应的数据变动，都对应记录在数据data:spu中；（包括新增属性名、新增属性值、修改已有的属性值、删除已有的属性值）。")]),t._v(" "),a("p",[t._v("其间的数据操作还包括属性值的input输入和button点击的变动，输入文本的检验，上传图片及删除上传图片、上传图片的放大展示等。")]),t._v(" "),a("p",[t._v("3、销售属性的添加")]),t._v(" "),a("p",[t._v("定义computed属性：unSelectedSaleAttr（当前SPU中还未添加属性值的销售属性）；页面上的待添加的销售属性就从其中进行选择；")]),t._v(" "),a("p",[t._v("点击添加某条销售属性后，还需要为其添加属性值；点击属性值列表里的“添加”按钮，隐藏button，显示input，等待用户输入；")]),t._v(" "),a("p",[t._v("输入完毕后对用户的输入进行判断，不满足条件进行提示，满足条件则将数据保存至data。")]),t._v(" "),a("p",[t._v("3、保存对spu属性、属性值的编辑")]),t._v(" "),a("p",[t._v("用户点击保存，调用保存属性、属性值数据的API，向服务器发送请求；服务器返回成功则弹出消息框提示，切换回spu展示页面。")])])}),[],!1,null,null,null);a.default=n.exports}}]);